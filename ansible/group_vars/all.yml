---
# Global variables for all hosts

# Docker configuration
docker_users:
  - "{{ ansible_user }}"

# Firewall rules
ufw_rules:
  - { rule: 'allow', port: '22', proto: 'tcp' }      # SSH
  - { rule: 'allow', port: '80', proto: 'tcp' }      # HTTP
  - { rule: 'allow', port: '443', proto: 'tcp' }     # HTTPS

# Nginx configuration
nginx_sites:
  - name: streamline
    domain: "{{ domain_name }}"
    port: "{{ app_port }}"
    enable_ssl: "{{ enable_ssl }}"

# Environment variables (loaded from GitHub secrets)
env_vars:
  PORT: "{{ app_port }}"
  BETTER_AUTH_URL: "{{ lookup('env', 'BETTER_AUTH_URL') }}"
  POSTGRES_USER: "{{ lookup('env', 'POSTGRES_USER') }}"
  POSTGRES_PASSWORD: "{{ lookup('env', 'POSTGRES_PASSWORD') }}"
  POSTGRES_DB: "{{ lookup('env', 'POSTGRES_DB') }}"
  BETTER_AUTH_SECRET: "{{ lookup('env', 'BETTER_AUTH_SECRET') }}"
  BETTER_AUTH_GITHUB_CLIENT_ID: "{{ lookup('env', 'BETTER_AUTH_GITHUB_CLIENT_ID') | default('') }}"
  BETTER_AUTH_GITHUB_CLIENT_SECRET: "{{ lookup('env', 'BETTER_AUTH_GITHUB_CLIENT_SECRET') | default('') }}"
  STRIPE_SECRET_KEY: "{{ lookup('env', 'STRIPE_SECRET_KEY') }}"
  STRIPE_WEBHOOK_SECRET: "{{ lookup('env', 'STRIPE_WEBHOOK_SECRET') }}"
  NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY: "{{ lookup('env', 'NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY') }}"
  STRIPE_PRICE_PERSONAL_MANAGED_MONTHLY: "{{ lookup('env', 'STRIPE_PRICE_PERSONAL_MANAGED_MONTHLY') }}"
  STRIPE_PRICE_PERSONAL_MANAGED_YEARLY: "{{ lookup('env', 'STRIPE_PRICE_PERSONAL_MANAGED_YEARLY') }}"
  STRIPE_PRICE_BUSINESS_MANAGED: "{{ lookup('env', 'STRIPE_PRICE_BUSINESS_MANAGED') }}"
  STRIPE_PRICE_BUSINESS_SELFHOSTED: "{{ lookup('env', 'STRIPE_PRICE_BUSINESS_SELFHOSTED') }}"
  NEXT_PUBLIC_STREAMLINE_SCHEDULER_URL: "{{ lookup('env', 'NEXT_PUBLIC_STREAMLINE_SCHEDULER_URL') }}"
  NODE_ENV: production

